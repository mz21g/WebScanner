# 网络扫描器

*开发环境：pycharm professional 2019.2 + python 3.7.4 + scapy 2.4.3 + PyQt5 5.14.1*

---
### 主要实现的功能有:
:one: **主机探测**

探测目标主机是否在线

主要方法：

* arp探测：向目标主机发送ARP广播包（目的IP为目标主机的IP，目的MAC全为F）
* icmp探测：向目标主机发送ICMP数据包
* syn_443端口探测：向目标主机的443端口发送标志位为SYN的TCP数据包
* ack_80端口探测：向目标主机的80端口发送标志位为ACK的TCP数据包

向目标主机发送上述相应方法的数据包，如果收到响应包则说明主机在线

:two: **端口扫描**

探测目标主机的端口是否开放

主要方法

* SYN端口扫描：向目标主机的目标端口发送标志位为 SYN 的TCP数据包
* FIN端口扫描：向目标主机的目标端口发送标志位为 FIN 的TCP数据包
* XMAS端口扫描：向目标主机的目标端口发送标志位为 PSH | FIN | URG 的TCP数据包
* NULL端口扫描：向目标主机的目标端口发送标志位为空的TCP数据包
* UDP端口扫描：向目标主机的目标端口发送UDP数据包

如果目标主机的目标端口开放

* SYN端口扫描会返回标志位为  SYN | ACK  的数据包
* FIN、XMAS、NULL、UDP端口扫描一般不会回复

:three: **服务识别**

探测目标主机开放端口上运行的具体软件名、版本号等，调用nmap实现

:four:**操作系统探测**

探测目标主机的操作系统是Linux还是Windows

主要方法：

* ICMP数据包的TTL值：TTL值大于64一般为Windows系列，否则为Linux
* FIN探测：向目标主机发送FIN报文，Linux系列一般不会回复，Windows系列一般会回复标志位为 RST | ACK 的数据包
* 标记位探测：向目标主机发送标志位为 SYN | ECE 的TCP数据包，如果回复的数据包的标志位为  SYN | ACK | ECE 则为Linux系列
* TCP初始窗口：向目标主机的开放端口发送标志位为SYN的TCP数据包，看回复的数据包的窗口大小,如果为0x402E则为Windows系列
* ACK值：向目标主机的关闭端口发送标志位为 FIN | PSH | URG 的TCP数据包，如果响应包中SEQ值+1与ACK值相同则说明操作系统为Windows 系列
* 服务类型TOS：向目标主机的关闭端口发送UDP数据包，如果响应包中TOS值为0xC0则说明操作系统为Linux系列

:five: **FTP弱口令检测**

实现FTP匿名登录和字典暴力破解，支持字典文件直接拖动，shodan直接获取开放FTP服务的目标主机

:six:**SQL注入漏洞检测**

实现一个简单的目标网站的SQL注入漏洞检测

主要方法：

* 单引号探测
* and 1=1
* and 1= 2
* ' and '1'='1
* ' and '1'='2